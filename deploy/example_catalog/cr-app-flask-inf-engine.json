{
    "apiVersion": "kubedirector.hpe.com/v1beta1",
    "kind": "KubeDirectorApp",
    "metadata": {
        "name": "flask-and-inf-eng"
    },

    "spec": {
        "distroID": "bluedata/flask-and-inf-eng",
        "version": "1.8",
        "label": {
            "name": "Deployment Cluster",
            "description": "Deployment cluster with Endpoint Wrapper and Inference Engine"
        },

        "systemdRequired": true,
        "configSchemaVersion": 7,

        "categories": [ 
            "AIML/Deployment"
        ],

        "services":[
            {
                "id": "haproxy-stats",
                "label": { 
                    "name": "Model serving request balancer stats" 
                },
                "endpoint" : {
                    "urlScheme" : "http", 
                    "port" : 8081,
                    "isDashboard" : true
                }
            },
            {
                "id": "ssh",
                "label": { 
                    "name": "SSH" 
                },
                "endpoint" : {
                    "port" : 22,
                    "isDashboard" : false
                }
            },
            { 
                "endpoint": {
                    "urlScheme": "http", 
                    "isDashboard": false, 
                    "port": 10001,
                    "auth_token": true
                }, 
                "id": "gunicorn", 
                "label": {
                    "name": "API Server"
                }
            },
            { 
                "exported_service": "AIML/Deployment", 
                "endpoint": {
                    "urlScheme": "http", 
                    "path": "/<<model_name>>/<<model_version>>/predict", 
                    "isDashboard": false, 
                    "port": 32700,
                    "auth_token": true 
                }, 
                "id": "haproxy", 
                "label": { 
                    "name" : "Model Serving LoadBalancer" 
                }
            },
            {
                "id": "httpd",
                "label": { 
                    "name": "Apache HTTP Server" 
                }
            }

        ],

        "defaultImageRepoTag": "docker.io/saurabhjogalekarhpe/flask-and-inf-eng",
        "defaultConfigPackage":  {
            "packageURL": "http://16.143.21.166/thirdparty/k8sapps/flask_configure/flask_configure.tgz"
        },

        "roles":[
            {
                "id": "LoadBalancer",
                "cardinality": "1"
            },
            {
                "id": "RESTServer",
                "cardinality": "1+"

            }
        ],

        "config": {
            "selectedRoles": [ 
                "RESTServer", 
                "LoadBalancer"
            ],
            "roleServices": [
                {
                    "roleID": "RESTServer",
                    "serviceIDs": [ 
                        "gunicorn", 
                        "ssh" 
                    ]
                },
                {
                    "roleID": "LoadBalancer",
                    "serviceIDs": [ 
                        "gunicorn", 
                        "haproxy", 
                        "haproxy-stats"
                    ]
                }
            ]
        }





    }



}