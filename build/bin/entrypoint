#!/bin/sh -e

# This is documented here:
# https://docs.openshift.com/container-platform/3.11/creating_images/guidelines.html#openshift-specific-guidelines

if ! whoami &>/dev/null; then
  if [ -w /etc/passwd ]; then
    echo "kubedirector:x:$(id -u):$(id -g):kubedirector user:/home/kubedirector:/sbin/nologin" >> /etc/passwd
  fi
fi

mkfifo /tmp/fifo; (/home/kubedirector/kubedirector $@ &> /tmp/fifo) & while true; do cat /tmp/fifo; done
